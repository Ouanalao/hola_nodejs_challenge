module.exports.filter=p;function p(d,a){var b=Object.keys(d),g=b.length,c=a.length,f,e,h,k={},m,l,n;for(f=0;f<c;f++)l=a[f],l.from&&(l.i=q(l.from)),l.to&&(l.j=q(l.to));for(f=0;f<g;f++){h=b[f];m=d[h];n=[];for(e=0;e<c;e++)l=a[e],r(m.from,l.i)&&r(m.to,l.j)&&n.push(l.action);k[h]=n}return k}
function t(d,a,b,g,c,f){for(var e;c<f;c++){e=a[c];if(0===e){if(f===c+1)return!0;c++;e=!0;for(var h=c;h<f;h++)if(0===a[h]){e=!1;break}if(e){a:{e=0;for(var h=c,k=void 0,m=void 0,k=void 0;h<f;h++)k=a[h],e="number"===typeof k?e+k:e+k.length;for(;b<g&&e<=g-b;b++){h=b;for(k=c;k<f;k++)if(m=a[k],"number"===typeof m)h+=m;else{if(!u(d,m,h))break;h+=m.length}if(k===f){d=!0;break a}}d=!1}return d}for(;b<g;b++)if(e=t(d,a,b,g,c,f))return!0;return!1}if(b>=g)return!1;if(1===e)b++;else{if(!u(d,e,b))return!1;b+=e.length}}return b===
    g}function r(d,a){return a?a.c?v(d,0,d.length,a.c,0,a.c.length):a.text?a.text===d:a.f?d.length===a.f:0<a.a&&!v(d,0,a.g,a.pattern,0,a.a)||a.b<a.pattern.length-1&&!v(d,d.length-a.h,d.length,a.pattern,a.b+1,a.pattern.length)?!1:a.a===a.b?!0:t(d,a.pattern,a.g,d.length-a.h,a.a,a.b):!0}function v(d,a,b,g,c,f){for(var e;c<f;c++)if(e=g[c],"number"===typeof e){if(a+=e,a>b)return!1}else{if(!u(d,e,a))return!1;a+=e.length}return a===b}
function q(d){for(var a=0,b=d.length,g=[],c,f;a<b;a++)if(c=d.charAt(a),"?"===c){for(c=1;++a<d.length&&"?"===d[a];)c++;a--;g.push(c)}else if("*"===c)for(g.push(0);a+1<b&&"*"===d.charAt(a+1);)a++;else{f=c;for(a++;a<b;a++){c=d.charAt(a);if("?"===c||"*"===c){a--;break}f+=c}g.push(f)}if(1!==g.length||0!==g[0]){d=!1;for(var b=0,e=f=!0,a=0;a<g.length;a++)if(c=g[a],0===c){d=a;f=e=!1;break}else"number"===typeof c?(e=!1,b+=c):(f=!1,b+=c.length);if(e)return{text:g[0]};if(f)return{f:g[0]};if(!1===d)return{c:g};
    f={pattern:g,a:d,g:b,m:e,l:f};if(!1!==d){e=d;b=0;for(a=g.length-1;a>d;a--)if(c=g[a],0===c){e=a;break}else"number"===typeof c?b++:b+=c.length;f.b=e;f.h=b}return f}}function u(d,a,b){var g=b+a.length;if(g>d.length||g-b>a.length)return!1;for(var c=0;b<g;b++,c++)if(d.charAt(b)!==a.charAt(c))return!1;return!0}