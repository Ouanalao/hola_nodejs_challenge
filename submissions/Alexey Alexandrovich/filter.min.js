'use strict';
function f1(b){return'.'===b||'\\'===b||'+'===b||'['===b||']'===b||'|'===b||'{'===b||'}'===b||'('===b||')'===b||'$'===b||'^'===b}function f2(b){return f1(b)?'\\'+b:'*'===b?'.*':'?'===b?'.{1}':b}function f3(b){for(var m='',t=0;m+=f2(b.charAt(t++)),t!==b.length;);return m}function f5(b){return new RegExp('^'+f3(b)+'$')}function f4(b){return 0<=b.indexOf('*')||0<=b.indexOf('?')}
function f0(b,m){var t=m.length,c,d,l=[],n=[];c=[];var a=[],f=[],e={},h,k,p=0,g,u,v,y;g=0;var q={},r={},w,x;m.reverse();for(k in b)d=b[k],l.push(d.from),p=d.from.charAt(0),c.push(p),n.push(d.to),d=d.to.charAt(0),a.push(d),f.push(k),e[k]=[],q[p]&&q[p].push(g)||(q[p]=[g]),r[d]&&r[d].push(g)||(r[d]=[g]),g++;for(p=l.length;t--;)if(c=m[t],d=c.from?c.from.charAt(0):null,h=c.to?c.to.charAt(0):null,w='*'===d||'?'===d,x='*'===h||'?'===h,k=d&&(w||f4(c.from)),g=h&&(x||f4(c.to)),k&&(u=f5(c.from)),
g&&(v=f5(c.to)),a=p,d||h)if(d)if(h)for(;a--;)(d=k?u.test(l[a]):l[a]===c.from)&&(y=g?v.test(n[a]):n[a]===c.to),d&&y&&e[f[a]].push(c.action);else if(w)for(;a--;)k?u.test(l[a])&&e[f[a]].push(c.action):l[a]===c.from&&e[f[a]].push(c.action);else for(a=q[d].length;a--;)k?u.test(l[q[d][a]])&&e[f[a]].push(c.action):l[q[d][a]]===c.from&&e[f[a]].push(c.action);else if(x)for(;a--;)g?v.test(n[a])&&e[f[a]].push(c.action):n[a]===c.to&&e[f[a]].push(c.action);else for(a=r[h].length;a--;)g?v.test(n[r[h][a]])&&
e[f[a]].push(c.action):n[r[h][a]]===c.to&&e[f[a]].push(c.action);else for(;a--;)e[f[a]].push(c.action);return e}module.exports=f0;